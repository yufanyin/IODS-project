# About the project
**Introduction ~~Warmup~~**
"Introduction"
"It is a good beginning. The task in DataCamp is friendly to beginners."
"Clustering and classification, and dimensionality reduction techniques are the two parts I am most interested in."
"I heard this course via email sent to HYMY students."
"My github repository is at:<https://github.com/yufanyin/IODS-project>
# About the project
**Introduction ~~Warmup~~**
"Introduction"
"It is a good beginning. The task in DataCamp is friendly to beginners."
"Clustering and classification, and dimensionality reduction techniques are the two parts I am most interested in."
"I heard this course via email sent to HYMY students."
"My github repository is at:<https://github.com/yufanyin/IODS-project>
---
title: "IODS course project"
author: "yufanyin"
output:
html_document:
theme: cosmo
toc: true
toc_depth: 2
fig_caption: true
fig_width: 6
fig_height: 4
---
install.packages("C:/Program Files/R/R-3.6.1/library/digest_0.6.22.tar.gz", repos = NULL, type = "source")
install.packages("evaluate")
install.packages("C:/Program Files/R/R-3.6.1/library/digest_0.6.22.tar.gz", repos = NULL, type = "source")
install.packages("evaluate")
install.packages("evaluate")
JYTOPKYS3.data <- read.delim("G:/C-Open Data Science/0-191030/IODS-project-master/JYTOPKYS3-data.txt", header=FALSE)
View(JYTOPKYS3.data)
lrn14 <- read.table(file = "https://www.mv.helsinki.fi/home/kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep="\t", header=TRUE)
install.packages("readdata1")
ï¼Ÿselect()
?select
?select()
library(dplyr)
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
head(mat)
head(student-mat)
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-mat.xls", sep="\t", header=TRUE)
getwd()setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-mat.xls", sep="\t", header=TRUE)
lrn14 <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-por.csv", sep="\t", header=TRUE)
head(student-mat)
lrn14 <- read.table(file = "student-por.csv", sep="\t", header=TRUE)
matrix(data, nrow = rows, ncol = cols) <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
mat <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
por <- read.table(file = "student-por.csv", sep="\t", header=TRUE)
head(student-mat)
head(mat)
# read the data into memory
lrn14 <- read.table("G:/C-Open Data Science/0-191030/IODS-project-master", sep="\t", header=student-mat)
# read the data into memory
mat <- read.table("G:/C-Open Data Science/0-191030/IODS-project-master", sep="\t", header=student-mat)
mat <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-mat.csv",
sep = ";", header = TRUE)
mat <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-mat.csv", sep = ";", header = TRUE)
mat <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-mat.csv", sep = ";", header = TRUE)
head(mat)
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
por <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-por.csv", sep = ";", header = TRUE)
dim(por)
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
mat <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-mat.csv", sep = ";", header = TRUE)
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
por <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-por.csv", sep = ";", header = TRUE)
head(mat)
dim(mat)
str(mat)
head(por)
dim(por)
str(por)
library(dplyr)
?inner_join # check the data join options of the dplyr package
# define the common columns of the data set ("comcol")
comcol <- c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet")
comcol # check the input
# Join the two data sets
mat_por <- inner_join(mat, por, by = comcol, suffix = c(".mat", ".por"))
dim(mat_por)
str(mat_por)
glimpse(mat_por)
colnames(mat_por)
# Create a new data frame "alc" with only the common columns
alc <- select(mat_por, one_of(comcol))
dim(alc)
head(alc)
# Create a new data frame "alc" using the common columns
alc <- select(mat_por, one_of(comcol))
dim(alc)
head(alc)
# Define the columns "unused" that were not used to join the two data sets
unused <- colnames(mat)[!colnames(mat) %in% comcol]
# Check the columns not used for joining
unused
# select two columns from 'mat_por' with the same original name
two_col <- select(mat_por, starts_with(col_name))
for(col_name in unused) {
# select two columns from 'mat_por' with the same original name
two_col <- select(mat_por, starts_with(col_name))
# select the first column vector of those two columns
first_col <- select(two_col, 1)
# if that first column vector is numeric...
if(is.numeric(first_col)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[col_name] <- round(rowMeans(two_col))
} else { # else if it's not numeric...
# add the first column vector to the alc data frame
alc[col_name] <- first_col
}
}
for(col_name in unused) {
two_col <- select(mat_por, starts_with(col_name))
first_col <- select(two_col, 1) # if that first column vector is numeric
if(is.numeric(first_col)) {
alc[col_name] <- round(rowMeans(two_col))
} else { # else if it's not numeric...
alc[col_name] <- first_col
}
}
# glimpse at the new combined data and check dimensions and first six rows
head(alc)
dim(alc)
glimpse(alc)
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
head(alc) # check the new column
# Define a new column "high_use": alc_use greater than 2
alc <- mutate(alc, high_use = alc_use > 2)
head(alc)
dim(alc)
glimpse(alc)
write.csv(alc, file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv", sep = "\t", col.names = TRUE, row.names = TRUE)
write.csv(alc, file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv")
# Check if the file can be read
read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv") %>% head()
learning2014 %>% str()
learning2014 <-
read.table(file = "G:/C-Open Data Science/0-191030/IODS-project-master/learning2014.txt", stringsAsFactors = TRUE)
learning2014 %>% str()
learning2014 %>% str()
learning2014%>%str()
str(learning2014)
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
alc <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv", sep = ";", header = TRUE)
alc <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv", sep = ";", header = TRUE)
alc
alc <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv")
alc
dim(alc)
str(alc)
colnames(alc)
dim(alc)
str(alc)
library(tidyr)
install.packages("tidyr")
library(tidyr)
library(dplyr)
library(ggplot2)
library(knitr)
library(kableExtra)
install.packages("kableExtra")
library(kableExtra)
alc %>% group_by(sex) %>% summarise(count = n()) -> fm
knitr::kable(fm, caption="Students") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "darkred", alpha = 0.7) + ggtitle("Overview bar plot of gathered variables") + xlab("Value") + ylab("Count") -> alc_gather
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot of gathered variables") + xlab("Value") + ylab("Count") -> alc_gather
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot of gathered variables") + xlab("Value") + ylab("Count") -> alc_gather
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot") + xlab("Value") + ylab("Count") -> alc_gather
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot") + xlab("Value") + ylab("Count")
ggsave("alc_gather.png", plot = alc_gather, path = "G:/C-Open Data Science/0-191030/IODS-project-master/", scale = 2, dpi = 300)
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot") + xlab("Value") + ylab("Count")-> alc_barplot
ggsave("alc_gather.png", plot = alc_barplot, path = "G:/C-Open Data Science/0-191030/IODS-project-master/", scale = 2, dpi = 300)
alc_barplot<-gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot") + xlab("Value") + ylab("Count")
ggplot(data = alc, aes(x = alc_use, fill = sex)) + geom_bar() + xlab("Average alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = sex)) + geom_bar() + xlab("Alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption and gender") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and gender 2") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption and gender") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
knitr::kable(fm, caption="Students") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
knitr::kable(fm, caption="Students' gender distribution") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
knitr::kable(fm, caption="Students' gender distribution") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption and gender") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
ggplot(data = alc, aes(x = failures, y = high_use)) + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption and number of class failures") + ylab("Numeber of students"))
ggplot(data = alc, aes(x = failures, y = high_use)) + geom_violin()  + ggtitle("Alcohol consumption and number of class failures") + xlab("High alcohol consumption") + ylab("Class failures") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("failures") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and number of class failures") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
### 3.3.2 Alcohol consumption and number of class failures
ggplot(data = alc, aes(x = alc_use, fill = failures)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Gender")
### 3.3.2 Alcohol consumption and number of class failures
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("failures") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Gender")
### 3.3.2 Alcohol consumption and number of class failures
ggplot(data = alc, aes(x = failures, fill = alc_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Gender")
knitr::kable(fm, caption="Students' gender distribution") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
ggplot(data = alc, aes(x = alc_use, fill = sex)) + geom_bar() + xlab("Alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption and gender") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
("Numeber of students") + ggtitle("Alcohol consumption and
gender") + scale_fill_discrete("Gender", labels = c("Female",
"Male"))
ggplot(data = alc, aes(x = alc_use, fill = sex)) + geom_bar() + xlab("Alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption and gender") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption by gender") + ylab("Count") + scale_fill_discrete("High alcohol use")
ggplot(data = alc, aes(x = alc_use, fill = failures)) + geom_bar() + xlab("Alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption and number of class failures") + scale_fill_discrete("Number of class failures", labels = c("1", "2","3", "4"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("failures") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption by gender") + ylab("Count") + scale_fill_discrete("High alcohol use")
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of going out with friends") + xlab("times)") + ylab("Count") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption by gender") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
str(alc)
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of going out with friends") + xlab("number of going out with friends)") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of going out with friends") + xlab("number of going out with friends") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of going out with friends") + xlab("Number of going out with friends (1: very low / 5: very high") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and frequency of going out with friends") + xlab("Number of going out with friends (1: very low / 5: very high)") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = failures,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of class failures") + xlab("Number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = absences,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of school absences") + xlab("Number of school absences (from 0 to 93)") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = failures,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of class failures") + xlab("Number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and frequency of going out with friends") + xlab("Number of going out with friends (1: very low / 5: very high)") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and frequency of going out with friends") + xlab("Number of going out with friends (1: very low / 5: very high)") + ylab("Numeber of students") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
lr_glm <- glm(high_use ~ sex + failures + goout + absences, data = alc, family = "binomial")
lr_glm_sum <- summary(lr_glm)
cv_glm_sum
lr_glm_sum
knitr::kable(lr_glm_sum$coefficients, digits = 3, align = "l", justify = "left", caption="Model coefficients of choosen variables") %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
lr_glm_sum
or_lr <- coef(lr_glm) %>% exp
or_lr
ci_lr <- confint(lr_glm) %>% exp
ci_lr
od_conf <- cbind(or_lr, ci_lr)
colnames(od_conf) <- c("odds ratios","2.5 %", "97.5 %")
knitr::kable(od_conf, digits = 3, align = "l",  caption="Odds ratios and confidental intervals") %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
probabilities <- predict(lr_glm, type = "response")
prob <- predict(lr_glm, type = "response")
alc <- mutate(alc, probability = prob)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, age, failures, goout, absences, high_use, probability, prediction) %>% tail(20)
pred <- table(high_use = alc$high_use, prediction = alc$prediction)
knitr::kable(pred2_2, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Prediction" = 2)) %>%  pack_rows("High use", 1, 2)
knitr::kable(pred2_2, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
pred <- table(high_use = alc$high_use, pred = alc$prediction)
knitr::kable(pred2_2, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
probs <- predict(lr_glm, type = "response")
alc <- mutate(alc, prob = probs)
alc <- mutate(alc, pred = prob > 0.5)
select(alc, age, failures, goout, absences, high_use, prob, pred) %>% tail(20)
pred2 <- table(high_use = alc$high_use, pred = alc$pred)
knitr::kable(pred2, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$prob)
knitr::kable(lr_glm_sum$coefficients, digits = 3, align = "l", justify = "left", caption="Model coefficients of choosen variables") %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
lr_glm_sum
knitr::kable(od_conf, digits = 3, align = "l",  caption="Odds ratios and confidental intervals") %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
knitr::kable(pred22, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
pred22 <- table(high_use = alc$high_use, pred = alc$pred)
knitr::kable(pred22, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
loss_func(class = alc$high_use, prob = alc$prob)
library(boot)
cross_val<- cv.glm(data = alc, cost = loss_func, glmfit = cv_glm, K = 10)
cross_val<- cv.glm(data = alc, cost = loss_func, glmfit = lr_glm, K = 10)
cross_val$delta[1]
