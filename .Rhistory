# About the project
**Introduction ~~Warmup~~**
"Introduction"
"It is a good beginning. The task in DataCamp is friendly to beginners."
"Clustering and classification, and dimensionality reduction techniques are the two parts I am most interested in."
"I heard this course via email sent to HYMY students."
"My github repository is at:<https://github.com/yufanyin/IODS-project>
# About the project
**Introduction ~~Warmup~~**
"Introduction"
"It is a good beginning. The task in DataCamp is friendly to beginners."
"Clustering and classification, and dimensionality reduction techniques are the two parts I am most interested in."
"I heard this course via email sent to HYMY students."
"My github repository is at:<https://github.com/yufanyin/IODS-project>
---
title: "IODS course project"
author: "yufanyin"
output:
html_document:
theme: cosmo
toc: true
toc_depth: 2
fig_caption: true
fig_width: 6
fig_height: 4
---
install.packages("C:/Program Files/R/R-3.6.1/library/digest_0.6.22.tar.gz", repos = NULL, type = "source")
install.packages("evaluate")
install.packages("C:/Program Files/R/R-3.6.1/library/digest_0.6.22.tar.gz", repos = NULL, type = "source")
install.packages("evaluate")
install.packages("evaluate")
JYTOPKYS3.data <- read.delim("G:/C-Open Data Science/0-191030/IODS-project-master/JYTOPKYS3-data.txt", header=FALSE)
View(JYTOPKYS3.data)
lrn14 <- read.table(file = "https://www.mv.helsinki.fi/home/kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep="\t", header=TRUE)
install.packages("readdata1")
ï¼Ÿselect()
?select
?select()
library(dplyr)
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
head(mat)
head(student-mat)
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-mat.xls", sep="\t", header=TRUE)
getwd()setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-mat.xls", sep="\t", header=TRUE)
lrn14 <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
lrn14 <- read.table(file = "student-por.csv", sep="\t", header=TRUE)
head(student-mat)
lrn14 <- read.table(file = "student-por.csv", sep="\t", header=TRUE)
matrix(data, nrow = rows, ncol = cols) <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
mat <- read.table(file = "student-mat.csv", sep="\t", header=TRUE)
por <- read.table(file = "student-por.csv", sep="\t", header=TRUE)
head(student-mat)
head(mat)
# read the data into memory
lrn14 <- read.table("G:/C-Open Data Science/0-191030/IODS-project-master", sep="\t", header=student-mat)
# read the data into memory
mat <- read.table("G:/C-Open Data Science/0-191030/IODS-project-master", sep="\t", header=student-mat)
mat <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-mat.csv",
sep = ";", header = TRUE)
mat <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-mat.csv", sep = ";", header = TRUE)
mat <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-mat.csv", sep = ";", header = TRUE)
head(mat)
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
por <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-por.csv", sep = ";", header = TRUE)
dim(por)
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
mat <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-mat.csv", sep = ";", header = TRUE)
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
por <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/student-por.csv", sep = ";", header = TRUE)
head(mat)
dim(mat)
str(mat)
head(por)
dim(por)
str(por)
library(dplyr)
?inner_join # check the data join options of the dplyr package
# define the common columns of the data set ("comcol")
comcol <- c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet")
comcol # check the input
# Join the two data sets
mat_por <- inner_join(mat, por, by = comcol, suffix = c(".mat", ".por"))
dim(mat_por)
str(mat_por)
glimpse(mat_por)
colnames(mat_por)
# Create a new data frame "alc" with only the common columns
alc <- select(mat_por, one_of(comcol))
dim(alc)
head(alc)
# Create a new data frame "alc" using the common columns
alc <- select(mat_por, one_of(comcol))
dim(alc)
head(alc)
# Define the columns "unused" that were not used to join the two data sets
unused <- colnames(mat)[!colnames(mat) %in% comcol]
# Check the columns not used for joining
unused
# select two columns from 'mat_por' with the same original name
two_col <- select(mat_por, starts_with(col_name))
for(col_name in unused) {
# select two columns from 'mat_por' with the same original name
two_col <- select(mat_por, starts_with(col_name))
# select the first column vector of those two columns
first_col <- select(two_col, 1)
# if that first column vector is numeric...
if(is.numeric(first_col)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[col_name] <- round(rowMeans(two_col))
} else { # else if it's not numeric...
# add the first column vector to the alc data frame
alc[col_name] <- first_col
}
}
for(col_name in unused) {
two_col <- select(mat_por, starts_with(col_name))
first_col <- select(two_col, 1) # if that first column vector is numeric
if(is.numeric(first_col)) {
alc[col_name] <- round(rowMeans(two_col))
} else { # else if it's not numeric...
alc[col_name] <- first_col
}
}
# glimpse at the new combined data and check dimensions and first six rows
head(alc)
dim(alc)
glimpse(alc)
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
head(alc) # check the new column
# Define a new column "high_use": alc_use greater than 2
alc <- mutate(alc, high_use = alc_use > 2)
head(alc)
dim(alc)
glimpse(alc)
write.csv(alc, file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv", sep = "\t", col.names = TRUE, row.names = TRUE)
write.csv(alc, file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv")
# Check if the file can be read
read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv") %>% head()
learning2014 %>% str()
learning2014 <-
read.table(file = "G:/C-Open Data Science/0-191030/IODS-project-master/learning2014.txt", stringsAsFactors = TRUE)
learning2014 %>% str()
learning2014 %>% str()
learning2014%>%str()
str(learning2014)
getwd()
setwd("G:/C-Open Data Science/0-191030/IODS-project-master")
alc <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv", sep = ";", header = TRUE)
alc <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv", sep = ";", header = TRUE)
alc
alc <- read.csv(file = "G:/C-Open Data Science/0-191030/IODS-project-master/alc.csv")
alc
dim(alc)
str(alc)
colnames(alc)
dim(alc)
str(alc)
library(tidyr)
install.packages("tidyr")
library(tidyr)
library(dplyr)
library(ggplot2)
library(knitr)
library(kableExtra)
install.packages("kableExtra")
library(kableExtra)
alc %>% group_by(sex) %>% summarise(count = n()) -> fm
knitr::kable(fm, caption="Students") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "darkred", alpha = 0.7) + ggtitle("Overview bar plot of gathered variables") + xlab("Value") + ylab("Count") -> alc_gather
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot of gathered variables") + xlab("Value") + ylab("Count") -> alc_gather
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot of gathered variables") + xlab("Value") + ylab("Count") -> alc_gather
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot") + xlab("Value") + ylab("Count") -> alc_gather
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot") + xlab("Value") + ylab("Count")
ggsave("alc_gather.png", plot = alc_gather, path = "G:/C-Open Data Science/0-191030/IODS-project-master/", scale = 2, dpi = 300)
gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot") + xlab("Value") + ylab("Count")-> alc_barplot
ggsave("alc_gather.png", plot = alc_barplot, path = "G:/C-Open Data Science/0-191030/IODS-project-master/", scale = 2, dpi = 300)
alc_barplot<-gather(alc) %>% ggplot(aes(x = value)) + facet_wrap("key", scales = "free") + geom_bar(fill = "red", alpha = 0.7) + ggtitle("Overview bar plot") + xlab("Value") + ylab("Count")
ggplot(data = alc, aes(x = alc_use, fill = sex)) + geom_bar() + xlab("Average alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = sex)) + geom_bar() + xlab("Alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption and gender") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and gender 2") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption and gender") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
knitr::kable(fm, caption="Students") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
knitr::kable(fm, caption="Students' gender distribution") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
knitr::kable(fm, caption="Students' gender distribution") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption and gender") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
ggplot(data = alc, aes(x = failures, y = high_use)) + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption and number of class failures") + ylab("Numeber of students"))
ggplot(data = alc, aes(x = failures, y = high_use)) + geom_violin()  + ggtitle("Alcohol consumption and number of class failures") + xlab("High alcohol consumption") + ylab("Class failures") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("failures") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and number of class failures") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
### 3.3.2 Alcohol consumption and number of class failures
ggplot(data = alc, aes(x = alc_use, fill = failures)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Gender")
### 3.3.2 Alcohol consumption and number of class failures
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("failures") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Gender")
### 3.3.2 Alcohol consumption and number of class failures
ggplot(data = alc, aes(x = failures, fill = alc_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("Alcohol consumption and number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Gender")
knitr::kable(fm, caption="Students' gender distribution") %>% kable_styling(bootstrap_options = "hover", full_width = FALSE, position = "center")
ggplot(data = alc, aes(x = alc_use, fill = sex)) + geom_bar() + xlab("Alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption and gender") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
("Numeber of students") + ggtitle("Alcohol consumption and
gender") + scale_fill_discrete("Gender", labels = c("Female",
"Male"))
ggplot(data = alc, aes(x = alc_use, fill = sex)) + geom_bar() + xlab("Alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption and gender") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption by gender") + ylab("Count") + scale_fill_discrete("High alcohol use")
ggplot(data = alc, aes(x = alc_use, fill = failures)) + geom_bar() + xlab("Alcohol consumption (1: lowest / 5: highest)") + ylab("Numeber of students") + ggtitle("Alcohol consumption and number of class failures") + scale_fill_discrete("Number of class failures", labels = c("1", "2","3", "4"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("failures") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption by gender") + ylab("Count") + scale_fill_discrete("High alcohol use")
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of going out with friends") + xlab("times)") + ylab("Count") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = alc_use, fill = high_use)) + facet_wrap("sex") + geom_bar() + xlab("Student's alcohol consumption") + ggtitle("High alcohol consumption by gender") + ylab("Numeber of students") + scale_fill_discrete("High alcohol use")
str(alc)
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of going out with friends") + xlab("number of going out with friends)") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of going out with friends") + xlab("number of going out with friends") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of going out with friends") + xlab("Number of going out with friends (1: very low / 5: very high") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and frequency of going out with friends") + xlab("Number of going out with friends (1: very low / 5: very high)") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = failures,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of class failures") + xlab("Number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = absences,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of school absences") + xlab("Number of school absences (from 0 to 93)") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = failures,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and number of class failures") + xlab("Number of class failures") + ylab("Numeber of students") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and frequency of going out with friends") + xlab("Number of going out with friends (1: very low / 5: very high)") + ylab("Numeber of students") + scale_fill_discrete("Student's gender", labels = c("Female", "Male"))
ggplot(data = alc, aes(x = goout,  fill = sex)) + geom_bar() + facet_wrap("high_use") + ggtitle("Alcohol consumption and frequency of going out with friends") + xlab("Number of going out with friends (1: very low / 5: very high)") + ylab("Numeber of students") + scale_fill_discrete("Gender", labels = c("Female", "Male"))
lr_glm <- glm(high_use ~ sex + failures + goout + absences, data = alc, family = "binomial")
lr_glm_sum <- summary(lr_glm)
cv_glm_sum
lr_glm_sum
knitr::kable(lr_glm_sum$coefficients, digits = 3, align = "l", justify = "left", caption="Model coefficients of choosen variables") %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
lr_glm_sum
or_lr <- coef(lr_glm) %>% exp
or_lr
ci_lr <- confint(lr_glm) %>% exp
ci_lr
od_conf <- cbind(or_lr, ci_lr)
colnames(od_conf) <- c("odds ratios","2.5 %", "97.5 %")
knitr::kable(od_conf, digits = 3, align = "l",  caption="Odds ratios and confidental intervals") %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
probabilities <- predict(lr_glm, type = "response")
prob <- predict(lr_glm, type = "response")
alc <- mutate(alc, probability = prob)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, age, failures, goout, absences, high_use, probability, prediction) %>% tail(20)
pred <- table(high_use = alc$high_use, prediction = alc$prediction)
knitr::kable(pred2_2, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Prediction" = 2)) %>%  pack_rows("High use", 1, 2)
knitr::kable(pred2_2, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
pred <- table(high_use = alc$high_use, pred = alc$prediction)
knitr::kable(pred2_2, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
probs <- predict(lr_glm, type = "response")
alc <- mutate(alc, prob = probs)
alc <- mutate(alc, pred = prob > 0.5)
select(alc, age, failures, goout, absences, high_use, prob, pred) %>% tail(20)
pred2 <- table(high_use = alc$high_use, pred = alc$pred)
knitr::kable(pred2, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$prob)
knitr::kable(lr_glm_sum$coefficients, digits = 3, align = "l", justify = "left", caption="Model coefficients of choosen variables") %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
lr_glm_sum
knitr::kable(od_conf, digits = 3, align = "l",  caption="Odds ratios and confidental intervals") %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
knitr::kable(pred22, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
pred22 <- table(high_use = alc$high_use, pred = alc$pred)
knitr::kable(pred22, align = "l",  caption="2 x 2 cross tabulation" ) %>% kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% add_header_above(c(" " = 1, "Pred" = 2)) %>%  pack_rows("High use", 1, 2)
loss_func(class = alc$high_use, prob = alc$prob)
library(boot)
cross_val<- cv.glm(data = alc, cost = loss_func, glmfit = cv_glm, K = 10)
cross_val<- cv.glm(data = alc, cost = loss_func, glmfit = lr_glm, K = 10)
cross_val$delta[1]
library(MASS)
data("Boston")
dim(Boston)
colnames(Boston)
str(Boston)
colnames(Boston)
dim(Boston)
colnames(Boston)
str(Boston)
pairs(Boston)
ov_boston <- ggpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8)))
library(ggplot2)
ov_boston <- ggpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8)))
library(dplyr)
library(tidyr)
library(dplyr)
library(corrplot)
library(corplot)
library(ggplot2)
library(GGally)
library(knitr)
ov_boston <- ggpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8)))
library(kableExtra)
ov_boston <- ggpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8)))
ov_boston
ov_boston
ov_boston <- ggpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8))
ov_boston <- ggpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8))
ov_boston <- gpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8)))
ov_boston <- ggpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8)))
ov_boston
library(ggplot2)
library(GGally)
ov_boston <- ggpairs(Boston, mapping = aes(), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8)))
ov_boston
ov_boston <- ggpairs(Boston, mapping = aes(chas), title ="Overview of the Boston data", lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 2.8)))
ov_boston
pairs(Boston)
summary(Boston)
knitr::kable(summary(Boston)) %>% kable_styling(bootstrap_options = "striped", position = "center", font_size = 12) %>% scroll_box(width = "100%", height = "300px")
library(knitr)
knitr::kable(summary(Boston))%>%kable_styling(bootstrap_options = "striped", position = "center", font_size = 12) %>% scroll_box(width = "100%", height = "300px")
install.packages("corrplot")
summary(Boston)
corrplot(cor_matrix, method="circle", type="upper", cl.pos="b", tl.pos="d", tl.cex = 0.6)
library(corrplot)
corrplot(cor_matrix, method="circle", type="upper", cl.pos="b", tl.pos="d", tl.cex = 0.6)
cor_matrix<-cor(Boston) %>% round(digits = 2)
corrplot(cor_matrix, method="circle", type="upper", cl.pos="b", tl.pos="d", tl.cex = 0.6)
library(corrplot)
cor_matrix<-cor(Boston) %>% round(digits = 2)
cor_matrix<-cor(Boston) %>% round(digits = 2) corrplot(cor_matrix, method="circle", type="upper", cl.pos="b", tl.pos="d", tl.cex = 0.6)
library(corrplot)
cor_matrix<-cor(Boston) %>% round(digits = 2)
corrplot(cor_matrix, method="circle", type="upper", cl.pos="b", tl.pos="d", tl.cex = 0.6)
bos_select <- Boston[,c("crim","indus","nox","tax","lstat","medv")]
ov_bos_select <- ggpairs(bos_select, mapping = aes(),lower = list(combo = wrap("facethist", bins = 20)), upper = list(continuous = wrap("cor", size = 5)))
ov_bos_select
cor_matrix<-cor(Boston) %>% round(digits = 2)
knitr::kable(cor_matrix, caption="Correlation matrix values") %>% kable_styling(bootstrap_options = "striped", full_width = FALSE, position = "center") %>% scroll_box(width = "100%", height = "300px")
library(corrplot)
p.mat <- cor.mtest(cor_matrix)$p
corrplot(cor_matrix, method="circle", type="upper",  tl.cex = 0.6, p.mat = p.mat, sig.level = 0.01, title="Correlations of Boston data", mar=c(0,0,1,0))
corrplot(cor_matrix, method="circle", type="upper",  tl.cex = 0.6, p.mat = p.mat, sig.level = 0.001, title="Correlations of Boston data", mar=c(0,0,1,0))
corrplot(cor_matrix, method="circle", type="upper",  tl.cex = 0.6, p.mat = p.mat, sig.level = 0.01, title="Correlations of Boston data", mar=c(0,0,1,0))
bos_scaled <- scale(Boston)
summary(boston_scaled)
summary(bos_scaled)
bins <- quantile(bos_scaled$crim)
bos_scaled <- scale(Boston)
bins <- quantile(bos_scaled$crim)
boston_scaled <- as.data.frame(boston_scaled)
boston_scaled <- as.data.frame(bos_scaled)
summary(bos_scaled$crim)
bins <- quantile(bos$crim)
class(boston_scaled)
class(bos_scaled)
boston_scaled <- as.data.frame(bos_scaled)
summary(bos_scaled$crim)
bins <- quantile(bos_scaled$crim)
summary(bos_scaled$$crim)
summary(bos_scaled$crim)
summary(bos_scaled$crim)
bos_scaled <- scale(Boston)
summary(bos_scaled)
summary(crim)
summary(boston_scaled$crim)
bins <- quantile(bos_scaled$crim)
class(bos_scaled)
bos_scaled <- as.data.frame(bos_scaled)
summary(bos_scaled$crim)
bins <- quantile(bos_scaled$crim)
bins
crime <- cut(boston_scaled$crim, breaks = bins, include.lowest = TRUE, labels = c("low", "med_low", "med_high", "high"))
table(crime)
bins
crime <- cut(boston_scaled$crim, breaks = bins, include.lowest = TRUE, labels = c("low", "med_low", "med_high", "high"))
table(crime)
bos_scaled <- dplyr::select(bos_scaled, -crim)
bos_scaled <- data.frame(bos_scaled, crime)
bos_scaled
n_bos <- nrow(bos_scaled)
ind_bos <- sample(n_bos,  size = n_bos * 0.8)
boston_train <- bos_scaled[ind_boston,]
boston_train <- bos_scaled[ind_bos,]
boston_test <- bos_scaled[-ind_bos,]
correct_classes <- test$crime
correct_classes <- boston_test$crime
correct_classes
boston_test <- dplyr::select(boston_test, -crime)
boston_test
lda.fit <- lda(crime ~ ., data = boston_train)
lda.fit
lda.arrows <- function(x, myscale = 1, arrow_heads = 0.1, color = "orange", tex = 0.75, choices = c(1,2)){
heads <- coef(x)
arrows(x0 = 0, y0 = 0,
x1 = myscale * heads[,choices[1]],
y1 = myscale * heads[,choices[2]], col=color, length = arrow_heads)
text(myscale * heads[,choices], labels = row.names(heads),
cex = tex, col=color, pos=3)
}
classes <- as.numeric(train$crime)
classes <- as.numeric(bos_train$crime)
classes <- as.numeric(boston_train$crime)
plot(lda.fit, dimen = 2, col = classes, pch = classes)
classes <- as.numeric(boston_train$crime)
plot(lda.fit, dimen = 2, col = classes, pch = classes, main = "LDA biplot of Boston train set")
lda.arrows(lda.fit, myscale = 2)
lda.arrows(lda.fit, myscale = 1)
arrows(x0 = 0, y0 = 0,
x1 = myscale * heads[,choices[1]],
y1 = myscale * heads[,choices[2]], col=color, length = arrow_heads)
lda.arrows <- function(x, myscale = 1, arrow_heads = 0.1, color = "orange", tex = 0.75, choices = c(1,2)){
heads <- coef(x)
arrows(x0 = 0, y0 = 0,
x1 = myscale * heads[,choices[1]],
y1 = myscale * heads[,choices[2]], col=color, length = arrow_heads)
text(myscale * heads[,choices], labels = row.names(heads),
cex = tex, col=color, pos=3)
}
classes <- as.numeric(boston_train$crime)
plot(lda.fit, dimen = 2, col = classes, pch = classes, main = "LDA biplot of Boston train set")
lda.arrows(lda.fit, myscale = 1)
lda.pred <- predict(lda.fit, newdata = boston_test)
pred_table <- table(correct = correct_classes, predicted = lda.pred$class)
pred_table
data(Boston)
bos_scaled2 <- scale(Boston)
dist_eu <- dist(bos_scaled2)
summary(dist_eu)
dist_man <- dist(boston_scaled2, method = "manhattan")
dist_man <- dist(bos_scaled2, method = "manhattan")
summary(dist_man)
summary(dist_eu)
km_boston <- kmeans(bos_scaled2, centers = 3)
bos_km <- kmeans(bos_scaled2, centers = 3)
pairs(bos_scaled2, col = bos_km$cluster)
pairs(bos_scaled2[,1:5], col = bos_km$cluster)
pairs(bos_scaled2[,6:10], col = bos_km$cluster)
pairs(bos_scaled2[,11:14], col = bos_km$cluster)
set.seed(123)
k_max <- 10 # determine the number of clusters
twcss <- sapply(1:k_max, function(k){kmeans(boston_scaled2, k)$tot.withinss}) # calculate the total within sum of squares
twcss <- sapply(1:k_max, function(k){kmeans(bos_scaled2, k)$tot.withinss}) # calculate the total within sum of squares
qplot(x = 1:k_max, y = twcss, geom = 'line') # visualize the results
km_bos2 <- kmeans(bos_scaled2, centers = 3) # k-means clustering
pairs(bos_scaled2, col = km_bos2$cluster) # plot the data with clusters
bos_km2 <- kmeans(bos_scaled2, centers = 3) # k-means clustering
pairs(bos_scaled2, col = km_bos2$cluster) # plot the data with clusters
pairs(bos_scaled2, col = km_bos2$cluster) # plot the data with clusters
pairs(bos_scaled2[,1:5], col = bos_km2$cluster)
pairs(bos_scaled2[,1:5], col = bos_km2$cluster)
pairs(bos_scaled2[,6:10], col = bos_km2$cluster)
pairs(bos_scaled2[,11:14], col = bos_km2$cluster)
data(Boston)
bos_scaled3 <- scale(Boston)
bos_km3 <-kmeans(bos_scaled3, centers = 3)
cluster <- bos_km3$cluster
bos_scaled3 <- data.frame(bos_scaled3, cluster)
lda.fit_cluster <- lda(cluster ~ ., data = bos_scaled3)
lda.fit_cluster
lda.arrows <- function(x, myscale = 1, arrow_heads = 0.1, color = "orange", tex = 0.75, choices = c(1,2)){
heads <- coef(x)
arrows(x0 = 0, y0 = 0,
x1 = myscale * heads[,choices[1]],
y1 = myscale * heads[,choices[2]], col=color, length = arrow_heads)
text(myscale * heads[,choices], labels = row.names(heads),
cex = tex, col=color, pos=3)
}
classes3 <- as.numeric(bos_scaled3$cluster)
plot(lda.fit_cluster, dimen = 2, col = classes3, pch = classes3, main = "LDA biplot using three clusters")
lda.arrows(lda.fit_cluster, myscale = 2)
plot(lda.fit_cluster, dimen = 2, col = classes3, pch = classes3, main = "LDA biplot using three clusters")
model_predictors <- dplyr::select(train, -crime)
model_predictors <- dplyr::select(bos_train, -crime)
model_predictors <- dplyr::select(boston_train, -crime)
# check the dimensions
dim(model_predictors)
dim(lda.fit$scaling)
# matrix multiplication
matrix_product <- as.matrix(model_predictors) %*% lda.fit$scaling
matrix_product <- as.data.frame(matrix_product)
plot_ly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
plot_ly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
plot(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
library(plotly)
plotly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
plot_ly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
install.packages("plotly")
library(plotly)
plot_ly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
plotly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
plot(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
plotly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers')
# check the dimensions
dim(model_predictors)
dim(lda.fit$scaling)
plot_ly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers', color = train$crime)
plot_ly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers', color = boston_train$crime)
km3D <-kmeans(boston_scaled, centers = 4)
plot_ly(x = matrix_product$LD1, y = matrix_product$LD2, z = matrix_product$LD3, type= 'scatter3d', mode='markers', color = km3D$cluster[ind])
cor_matrix<-cor(Boston) %>% round(digits = 2)
knitr::kable(cor_matrix, caption="Correlation matrix values") %>% kable_styling(bootstrap_options = "striped", full_width = FALSE, position = "center") %>% scroll_box(width = "100%", height = "300px")
cor_matrix
crime <- cut(bos_scaled$crim, breaks = bins, include.lowest = TRUE, labels = c("low", "med_low", "med_high", "high"))
crime <- cut(bos_scaled$crim, breaks = bins, include.lowest = TRUE, labels = c("low", "med_low", "med_high", "high"))
